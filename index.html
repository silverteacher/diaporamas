<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;script&gt;</p>
<p class="p1">let slideCounter = 0;</p>
<p class="p1">const themes = {</p>
<p class="p1"><span class="Apple-converted-space">    </span>blue: { primary: '4472C4', secondary: '70AD47', background: 'FFFFFF' },</p>
<p class="p1"><span class="Apple-converted-space">    </span>green: { primary: '70AD47', secondary: '4472C4', background: 'FFFFFF' },</p>
<p class="p1"><span class="Apple-converted-space">    </span>purple: { primary: '7030A0', secondary: 'C55A11', background: 'FFFFFF' },</p>
<p class="p1"><span class="Apple-converted-space">    </span>orange: { primary: 'C55A11', secondary: '7030A0', background: 'FFFFFF' },</p>
<p class="p1"><span class="Apple-converted-space">    </span>red: { primary: 'C5504B', secondary: '4472C4', background: 'FFFFFF' }</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// Titres des diapositives fixes au début</p>
<p class="p1">const defaultSlides = [</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Diapo avec le titre et l'illustration",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Diapo avec le temps de la visio",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Diapo avec la présentation des animateurs",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Diapo avec le sommaire",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Diapo brise glace"</p>
<p class="p1">];</p>
<p class="p1">// Titres des diapositives fixes à la fin</p>
<p class="p1">const endSlides = [</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Diapo Pause",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Diapo des questions",</p>
<p class="p1"><span class="Apple-converted-space">    </span>"Diapo contact"</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">// Ajoute une diapositive (optionnellement pré-remplie)</p>
<p class="p1">function addSlide(defaultTitle = "") {</p>
<p class="p1"><span class="Apple-converted-space">    </span>slideCounter++;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const slidesContainer = document.getElementById('slidesContainer');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const slideDiv = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">    </span>slideDiv.className = 'slide-item';</p>
<p class="p1"><span class="Apple-converted-space">    </span>slideDiv.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button type="button" class="remove-slide" onclick="removeSlide(this)"&gt;×&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h4&gt;${defaultTitle ? defaultTitle : `Diapositive ${slideCounter}`}&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;input type="text" placeholder="Titre de la diapositive" name="slideTitle${slideCounter}" value="${defaultTitle}" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;textarea placeholder="Contenu de la diapositive (vous pouvez utiliser des puces avec - ou •)" name="slideContent${slideCounter}" required&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;select name="slideLayout${slideCounter}" onchange="toggleImageUpload(this, ${slideCounter})"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;option value="title"&gt;Titre et contenu&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;option value="bullets"&gt;Liste à puces&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;option value="image"&gt;Titre et image&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="image-upload" id="imageUpload${slideCounter}" style="display: none;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label for="imageFile${slideCounter}"&gt;📁 Choisir une image&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="file" id="imageFile${slideCounter}" accept="image/*" onchange="previewImage(this, ${slideCounter})"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;img class="image-preview" id="imagePreview${slideCounter}" alt="Aperçu"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;span class="image-info" id="imageInfo${slideCounter}"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>slidesContainer.appendChild(slideDiv);</p>
<p class="p1"><span class="Apple-converted-space">    </span>updateSlideCount();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function toggleImageUpload(selectElement, slideNumber) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const imageUpload = document.getElementById(`imageUpload${slideNumber}`);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (selectElement.value === 'image') {</p>
<p class="p1"><span class="Apple-converted-space">        </span>imageUpload.style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">        </span>imageUpload.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function previewImage(input, slideNumber) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const preview = document.getElementById(`imagePreview${slideNumber}`);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const info = document.getElementById(`imageInfo${slideNumber}`);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (input.files &amp;&amp; input.files[0]) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const file = input.files[0];</p>
<p class="p1"><span class="Apple-converted-space">        </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">        </span>reader.onload = function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>preview.src = e.target.result;</p>
<p class="p1"><span class="Apple-converted-space">            </span>preview.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">            </span>info.textContent = `${file.name} (${(file.size / 1024).toFixed(1)} KB)`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p1"><span class="Apple-converted-space">        </span>reader.readAsDataURL(file);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function removeSlide(button) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>button.parentElement.remove();</p>
<p class="p1"><span class="Apple-converted-space">    </span>updateSlideCount();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function updateSlideCount() {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const count = document.querySelectorAll('.slide-item').length;</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.getElementById('slideCount').textContent = `${count} diapositive(s)`;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">// Initialisation : Ajoute les diapositives fixes du début</p>
<p class="p1">document.addEventListener('DOMContentLoaded', function() {</p>
<p class="p1"><span class="Apple-converted-space">    </span>checkLibraryLoaded();</p>
<p class="p1"><span class="Apple-converted-space">    </span>defaultSlides.forEach(title =&gt; addSlide(title));</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">// Vérifie que la librairie est chargée</p>
<p class="p1">function checkLibraryLoaded() {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const maxAttempts = 50;</p>
<p class="p1"><span class="Apple-converted-space">    </span>let attempts = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const checkInterval = setInterval(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>attempts++;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (typeof PptxGenJS !== 'undefined') {</p>
<p class="p1"><span class="Apple-converted-space">            </span>clearInterval(checkInterval);</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('presentationForm').style.opacity = '1';</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else if (attempts &gt;= maxAttempts) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>clearInterval(checkInterval);</p>
<p class="p1"><span class="Apple-converted-space">            </span>alert('Erreur: Impossible de charger la bibliothèque PowerPoint. Veuillez actualiser la page.');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}, 100);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">// Gestion du formulaire</p>
<p class="p1">document.getElementById('presentationForm').addEventListener('submit', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">    </span>generatePowerPoint();</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">async function generatePowerPoint() {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const loading = document.getElementById('loading');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const successMessage = document.getElementById('successMessage');</p>
<p class="p1"><span class="Apple-converted-space">    </span>loading.classList.add('active');</p>
<p class="p1"><span class="Apple-converted-space">    </span>successMessage.classList.remove('active');</p>
<p class="p1"><span class="Apple-converted-space">    </span>try {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (typeof PptxGenJS === 'undefined') {</p>
<p class="p1"><span class="Apple-converted-space">            </span>throw new Error('La bibliothèque PowerPoint n\'est pas encore chargée. Veuillez attendre et réessayer.');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>const pptx = new PptxGenJS();</p>
<p class="p1"><span class="Apple-converted-space">        </span>const formData = new FormData(document.getElementById('presentationForm'));</p>
<p class="p1"><span class="Apple-converted-space">        </span>const title = formData.get('title');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const author = formData.get('author');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const themeName = formData.get('theme');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const theme = themes[themeName];</p>
<p class="p1"><span class="Apple-converted-space">        </span>pptx.author = author || 'Générateur PowerPoint';</p>
<p class="p1"><span class="Apple-converted-space">        </span>pptx.title = title;</p>
<p class="p1"><span class="Apple-converted-space">        </span>pptx.subject = 'Présentation générée automatiquement';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Diapositive de titre (optionnelle, car déjà dans la liste si tu veux la personnaliser)</p>
<p class="p1"><span class="Apple-converted-space">        </span>// const titleSlide = pptx.addSlide();</p>
<p class="p1"><span class="Apple-converted-space">        </span>// titleSlide.background = { color: theme.background };</p>
<p class="p1"><span class="Apple-converted-space">        </span>// titleSlide.addText(title, {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">    </span>x: 1, y: 2, w: 8, h: 2, fontSize: 44, color: theme.primary, bold: true, align: 'center'</p>
<p class="p1"><span class="Apple-converted-space">        </span>// });</p>
<p class="p1"><span class="Apple-converted-space">        </span>// if (author) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">    </span>titleSlide.addText(`Par ${author}`, {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">        </span>x: 1, y: 4.5, w: 8, h: 1, fontSize: 24, color: theme.secondary, align: 'center'</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>// }</p>
<p class="p1"><span class="Apple-converted-space">        </span>// titleSlide.addText(new Date().toLocaleDateString('fr-FR'), {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// <span class="Apple-converted-space">    </span>x: 1, y: 6, w: 8, h: 0.5, fontSize: 16, color: '666666', align: 'center'</p>
<p class="p1"><span class="Apple-converted-space">        </span>// });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Slides dynamiques (fixes du début + ajoutées par utilisateur)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const slides = document.querySelectorAll('.slide-item');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const slidePromises = Array.from(slides).map(async (slideElement, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const inputs = slideElement.querySelectorAll('input, textarea, select');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const slideTitle = inputs[0].value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const slideContent = inputs[1].value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const slideLayout = inputs[2].value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const slide = pptx.addSlide();</p>
<p class="p1"><span class="Apple-converted-space">            </span>slide.background = { color: theme.background };</p>
<p class="p1"><span class="Apple-converted-space">            </span>slide.addText(slideTitle, {</p>
<p class="p1"><span class="Apple-converted-space">                </span>x: 0.5, y: 0.5, w: 9, h: 1, fontSize: 28, color: theme.primary, bold: true</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (slideLayout === 'bullets') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const bulletPoints = slideContent.split('\n')</p>
<p class="p1"><span class="Apple-converted-space">                    </span>.filter(line =&gt; line.trim())</p>
<p class="p1"><span class="Apple-converted-space">                    </span>.map(line =&gt; line.replace(/^[-•]\s*/, ''));</p>
<p class="p1"><span class="Apple-converted-space">                </span>slide.addText(bulletPoints, {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>x: 0.5, y: 1.8, w: 9, h: 5, fontSize: 18, color: '333333', bullet: true</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (slideLayout === 'image') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>slide.addText(slideContent, {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>x: 0.5, y: 1.8, w: 4.5, h: 3, fontSize: 16, color: '333333', valign: 'top'</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>const imageInput = slideElement.querySelector('input[type="file"]');</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (imageInput &amp;&amp; imageInput.files &amp;&amp; imageInput.files[0]) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return new Promise((resolve) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">                        </span>reader.onload = function(e) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>slide.addImage({</p>
<p class="p1"><span class="Apple-converted-space">                                </span>data: e.target.result,</p>
<p class="p1"><span class="Apple-converted-space">                                </span>x: 5.5, y: 2, w: 4, h: 3</p>
<p class="p1"><span class="Apple-converted-space">                            </span>});</p>
<p class="p1"><span class="Apple-converted-space">                            </span>resolve();</p>
<p class="p1"><span class="Apple-converted-space">                        </span>};</p>
<p class="p1"><span class="Apple-converted-space">                        </span>reader.readAsDataURL(imageInput.files[0]);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>slide.addText('📷\n[Aucune image sélectionnée]\nUtilisez le bouton "Choisir une image"', {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>x: 5.5, y: 2, w: 4, h: 3, fontSize: 14, color: '888888',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>align: 'center', valign: 'middle', fill: { color: 'F5F5F5' },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>line: { color: 'CCCCCC', width: 1 }</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>slide.addText(slideContent, {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>x: 0.5, y: 1.8, w: 9, h: 5, fontSize: 18, color: '333333', valign: 'top'</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Ajoute les diapositives fixes de fin</p>
<p class="p1"><span class="Apple-converted-space">        </span>endSlides.forEach(title =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const slide = pptx.addSlide();</p>
<p class="p1"><span class="Apple-converted-space">            </span>slide.background = { color: theme.background };</p>
<p class="p1"><span class="Apple-converted-space">            </span>slide.addText(title, {</p>
<p class="p1"><span class="Apple-converted-space">                </span>x: 0.5, y: 0.5, w: 9, h: 1, fontSize: 28, color: theme.primary, bold: true</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>await Promise.all(slidePromises);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const fileName = title ? `${title.replace(/[^\w\s]/gi, '')}.pptx` : 'presentation.pptx';</p>
<p class="p1"><span class="Apple-converted-space">        </span>await pptx.writeFile({ fileName: fileName });</p>
<p class="p1"><span class="Apple-converted-space">        </span>loading.classList.remove('active');</p>
<p class="p1"><span class="Apple-converted-space">        </span>successMessage.classList.add('active');</p>
<p class="p1"><span class="Apple-converted-space">        </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>successMessage.classList.remove('active');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}, 5000);</p>
<p class="p1"><span class="Apple-converted-space">    </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>loading.classList.remove('active');</p>
<p class="p1"><span class="Apple-converted-space">        </span>alert('Une erreur est survenue lors de la génération du PowerPoint. Veuillez réessayer.');</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1">}</p>
<p class="p1">&lt;/script&gt;</p>
</body>
</html>
